# State effect pattern

effect get-state(): Int
effect set-state(value: Int): ()

fn counter() {
    let mut i = 0
    loop {
        if i >= 10 { break }
        let current = get-state()
        set-state(current + 1)
        i = i + 1
    }
}

let mut state = 0

handle get-state(resume) { resume(state) }
handle set-state(value, resume) { 
    state = value
    resume(())
}
counter()

"final: {state}"
