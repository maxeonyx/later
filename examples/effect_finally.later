# Cleanup runs even when effect aborts

effect fail(msg: String): Never

fn work() {
    defer { print("cleanup ran") }
    fail("boom")
    print("never reached")
}

handle fail(msg, resume: Drop) {
    print("caught: {msg}")
}
work()
# Prints: cleanup ran
#         caught: boom
